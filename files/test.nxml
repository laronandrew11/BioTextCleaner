
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article" xml:lang="en"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">Genome Biol</journal-id><journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id><journal-title-group><journal-title>Genome Biology</journal-title></journal-title-group><issn pub-type="ppub">1465-6906</issn><issn pub-type="epub">1465-6914</issn><publisher><publisher-name>BioMed Central</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">23618408</article-id><article-id pub-id-type="pmc">4053844</article-id><article-id pub-id-type="publisher-id">gb-2013-14-4-r36</article-id><article-id pub-id-type="doi">10.1186/gb-2013-14-4-r36</article-id><article-categories><subj-group subj-group-type="heading"><subject>Method</subject></subj-group></article-categories><title-group><article-title>TopHat2: accurate alignment of transcriptomes in the presence of insertions, deletions and gene fusions</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="A1"><name><surname>Kim</surname><given-names>Daehwan</given-names></name><xref ref-type="aff" rid="I1">1</xref><xref ref-type="aff" rid="I2">2</xref><xref ref-type="aff" rid="I3">3</xref><email>infphilo@umiacs.umd.edu</email></contrib><contrib contrib-type="author" id="A2"><name><surname>Pertea</surname><given-names>Geo</given-names></name><xref ref-type="aff" rid="I3">3</xref><email>gpertea@jhu.edu</email></contrib><contrib contrib-type="author" id="A3"><name><surname>Trapnell</surname><given-names>Cole</given-names></name><xref ref-type="aff" rid="I5">5</xref><xref ref-type="aff" rid="I6">6</xref><email>cole@broadinstitute.org</email></contrib><contrib contrib-type="author" id="A4"><name><surname>Pimentel</surname><given-names>Harold</given-names></name><xref ref-type="aff" rid="I7">7</xref><email>pimentel@cs.berkeley.edu</email></contrib><contrib contrib-type="author" id="A5"><name><surname>Kelley</surname><given-names>Ryan</given-names></name><xref ref-type="aff" rid="I8">8</xref><email>ryankelley@illumina.com</email></contrib><contrib contrib-type="author" id="A6"><name><surname>Salzberg</surname><given-names>Steven L</given-names></name><xref ref-type="aff" rid="I3">3</xref><xref ref-type="aff" rid="I4">4</xref><email>salzberg@jhu.edu</email></contrib></contrib-group><aff id="I1"><label>1</label>Center for Bioinformatics and Computational Biology, University of Maryland, College Park, MD, 20742, USA</aff><aff id="I2"><label>2</label>Department of Computer Science, University of Maryland, College Park, MD 20742, USA</aff><aff id="I3"><label>3</label>Center for Computational Biology, McKusick-Nathans Institute of Genetic Medicine, Johns Hopkins University School of Medicine, 733 N. Broadway, Baltimore, MD, 21205, USA</aff><aff id="I4"><label>4</label>Department of Biostatistics, Bloomberg School of Public Health, Johns Hopkins University, 615 N. Wolfe Street, Baltimore, MD, 21205, USA</aff><aff id="I5"><label>5</label>Broad Institute of MIT and Harvard, 7 Cambridge Center, Cambridge, MA, 02142, USA</aff><aff id="I6"><label>6</label>Department of Stem Cell and Regenerative Biology, Harvard University, 7 Divinity Ave., Cambridge, MA, 02142, USA</aff><aff id="I7"><label>7</label>Department of Electrical Engineering and Computer Science, University of California, 101 Sproul Hall, Berkeley, CA, 94720, USA</aff><aff id="I8"><label>8</label>Illumina Inc., 5200 Illumina Way, San Diego, CA, 92122, USA</aff><pub-date pub-type="ppub"><year>2013</year></pub-date><pub-date pub-type="epub"><day>25</day><month>4</month><year>2013</year></pub-date><volume>14</volume><issue>4</issue><fpage>R36</fpage><lpage>R36</lpage><history><date date-type="received"><day>15</day><month>11</month><year>2012</year></date><date date-type="rev-recd"><day>5</day><month>4</month><year>2013</year></date><date date-type="accepted"><day>25</day><month>4</month><year>2013</year></date></history><permissions><copyright-statement>Copyright &#x000a9; 2013 Kim et al.; licensee BioMed Central Ltd.</copyright-statement><copyright-year>2013</copyright-year><copyright-holder>Kim et al.; licensee BioMed Central Ltd.</copyright-holder><license license-type="open-access"><license-p>This is an open access article distributed under the terms of the Creative Commons Attribution License</license-p></license></permissions><self-uri xlink:href="http://genomebiology.com/2013/14/4/R36"/><abstract><p>TopHat is a popular spliced aligner for RNA-sequence (RNA-seq) experiments. In this paper, we describe TopHat2, which incorporates many significant enhancements to TopHat. TopHat2 can align reads of various lengths produced by the latest sequencing technologies, while allowing for variable-length indels with respect to the reference genome. In addition to <italic>de novo </italic>spliced alignment, TopHat2 can align reads across fusion breaks, which can occur after genomic translocations. TopHat2 combines the ability to identify novel splice sites with direct mapping to known transcripts, producing sensitive and accurate alignments, even for highly repetitive genomes or in the presence of pseudogenes. TopHat2 is available at <ext-link ext-link-type="uri" xlink:href="http://ccb.jhu.edu/software/tophat">http://ccb.jhu.edu/software/tophat</ext-link>.</p></abstract></article-meta></front><body><sec><title>Background</title><p>RNA-sequencing technologies [<xref ref-type="bibr" rid="B1">1</xref>], which sequence the RNA molecules being transcribed in cells, allow exploration of the process of transcription in exquisite detail. One of the primary goals of RNA-sequencing analysis software is to reconstruct the full set of transcripts (isoforms) of genes that were present in the original cells. In addition to the transcript structures, experimenters need to estimate the expression levels for all transcripts. The first step in the analysis process is to map the RNA-sequence (RNA-seq) reads against the reference genome, which provides the location from which the reads originated. In contrast to DNA-sequence alignment, RNA-seq mapping algorithms have two additional challenges. First, because genes in eukaryotic genomes contain introns, and because reads sequenced from mature mRNA transcripts do not include these introns, any RNA-seq alignment program must be able to handle gapped (or spliced) alignment with very large gaps. In mammalian genomes, introns span a very wide range of lengths, typically from 50 to 100,000 bases, which the alignment algorithm must accommodate. Second, the presence of processed pseudogenes, from which some or all introns have been removed, may cause many exon-spanning reads to map incorrectly. This is particularly acute for the human genome, which contains over 14,000 pseudogenes [<xref ref-type="bibr" rid="B2">2</xref>].</p><p>In the most recent Ensembl GRCh37 gene annotations, the average length of a mature mRNA transcript in the human genome is 2,227 bp long, and the average exon length is 235 bp. The average number of exons per transcript is 9.5. Assuming that sequencing reads are uniformly distributed along a transcript [<xref ref-type="bibr" rid="B3">3</xref>], we would expect 33 to 38% of 100 bp reads from an RNA-seq experiment to span two or more exons. Note that this proportion increases significantly as read length increases from 50 to 150 bp (see Additional file <xref ref-type="supplementary-material" rid="S1">1</xref> for more details).</p><p>More important for the alignment problem is that around 20% of junction-spanning reads extend by 10 bp or less into one of the exons they span. These small 'anchors' make it extremely difficult for alignment software to map reads accurately, particularly if the algorithm relies (as most do) on an initial mapping of fixed-length k-mers to the genome. This initial mapping, using exact matches of k-mers, is crucial for narrowing down the search space into small local regions in which a read is likely to align. If a read extends only a few bases into one of two adjacent exons, then it often happens that the read will align equally well, but incorrectly, with the sequence of the intervening intron. For example, as illustrated in Figure <xref ref-type="fig" rid="F1">1</xref>, suppose that read <italic>r </italic>spans exons <italic>e<sub>1 </sub></italic>and <italic>e<sub>2</sub></italic>, extending only four bases into <italic>e<sub>2</sub></italic>. Suppose also that that <italic>e<sub>2 </sub></italic>begins with GTXX, and the intervening intron also begins with GTXX, where X stands for any of A, G, C, and T. Then <italic>r </italic>might align perfectly to <italic>e<sub>1 </sub></italic>and the first four bases of the intron, and the alignment algorithm will fail to find the spliced alignment of <italic>r</italic>.</p><fig id="F1" position="float"><label>Figure 1</label><caption><p><bold>Two possible incorrect alignments of spliced reads</bold>. 1) A read extending a few bases into the flanking exon can be aligned to the intron instead of the exon. 2) A read spanning multiple exons from genes with processed pseudogene copies can be aligned to the pseudogene copies instead of the gene from which it originates.</p></caption><graphic xlink:href="gb-2013-14-4-r36-1"/></fig><p>In order to handle this problem, the software TopHat2 uses a two-step procedure. First, similar to TopHat1 [<xref ref-type="bibr" rid="B4">4</xref>], it detects potential splice sites for introns (detailed further in Methods). It uses these candidate splice sites in a subsequent step to correctly align multiexon-spanning reads. Some RNA-seq aligners, including GSNAP [<xref ref-type="bibr" rid="B5">5</xref>], RUM [<xref ref-type="bibr" rid="B6">6</xref>], and STAR [<xref ref-type="bibr" rid="B7">7</xref>], map reads independently of the alignments of other reads, which may explain their lower sensitivity for these spliced reads (see Results and discussion). MapSplice [<xref ref-type="bibr" rid="B8">8</xref>] uses a two-step approach similar to TopHat2.</p><p>RNA-seq read alignment is further complicated by the presence of processed pseudogenes in the reference genome. Pseudogenes often have highly similar sequences to functional, intron-containing genes. In most cases, the pseudogene versions are not transcribed [<xref ref-type="bibr" rid="B9">9</xref>], although this suggestion has recently been disputed [<xref ref-type="bibr" rid="B10">10</xref>]. The crucial problem for alignment is that reads spanning multiple exons can be mapped perfectly or near-perfectly to the pseudogene version of a functional gene. For example, suppose a read <italic>r </italic>spans two exons of a given gene. If the aligner tries to align the read globally (end to end), then it will find an alignment to the pseudogene copy (Figure <xref ref-type="fig" rid="F1">1</xref>). If the spliced alignment phase, which usually occurs later, does not attempt to realign <italic>r</italic>, then the pseudogene copy will 'absorb' all reads spanning the splice sites for that gene. TopHat2 can feed <italic>r </italic>into the spliced alignment phase even when <italic>r </italic>has been aligned end to end, allowing it to circumvent this problem (see Methods and Results and discussion sections).</p><p>We also note that, in our analysis of RNA-seq reads from multiple human samples [<xref ref-type="bibr" rid="B11">11</xref>,<xref ref-type="bibr" rid="B12">12</xref>], genes with processed pseudogenes seem to be expressed at higher levels compared with other genes (see Results and discussion). Although this observation has not been explored thoroughly, a plausible explanation is that genes with higher levels of expression may, over the course of evolution, have had an increased chance of being picked up by transposons and re-integrated into the genome, creating pseudogene copies.</p><p>Concerning the human genome, for which there are relatively comprehensive annotations of protein-coding genes, the annotations can be used to map reads more accurately by aligning the reads preferentially to real genes rather than pseudogenes. GSNAP [<xref ref-type="bibr" rid="B5">5</xref>] and STAR [<xref ref-type="bibr" rid="B7">7</xref>] also make use of annotation, although they use it in a more limited fashion in order to detect splice sites. TopHat2 can use the full-length transcripts defined by annotations during its initial mapping phase, which produces significant gains in sensitivity and accuracy (see Results and discussion).</p><p>Transcripts from a target genome may differ substantially from the reference genome, possibly containing insertions, deletions, and other structural variations [<xref ref-type="bibr" rid="B13">13</xref>,<xref ref-type="bibr" rid="B14">14</xref>]. For such regions, previous spliced alignment programs (including the original TopHat) sometimes fail to find a proper alignment. In TopHat2, we implemented new procedures to ensure that reads are aligned with true insertions and deletions (indels). Indels due to sequencing errors will be discovered by Bowtie2 [<xref ref-type="bibr" rid="B15">15</xref>], the underlying mapping engine of TopHat2, which can detect short indels very efficiently. In addition, very large deletions, inversions on the same chromosome, and translocations involving different chromosomes are detected by the TopHat-Fusion algorithms [<xref ref-type="bibr" rid="B16">16</xref>], which are now incorporated into TopHat2 and available by a simple command-line switch.</p><p>TopHat2 also includes new algorithms to handle more diverse types of sequencing data. This includes the ability to handle reads generated by ABI SOLiD technology (Life Technologies, Carlsbad, CA, USA) using its 'color space' representation. To accomplish this, TopHat2 uses a reference genome translated entirely into color space in order to take advantage of the error-correction capability of that format. TopHat2 also handles datasets in which the reads have variable lengths, allowing the experimenter to merge datasets from multiple sequencing runs with different lengths.</p></sec><sec><title>Results and discussion</title><p>TopHat2 can use either Bowtie [<xref ref-type="bibr" rid="B17">17</xref>] or Bowtie2 [<xref ref-type="bibr" rid="B15">15</xref>] as its core read-alignment engine. TopHat2 has its own indel-finding algorithm, which enhances indel-finding ability of Bowtie2 in the context of spliced alignments. In order to evaluate TopHat2 and compare it with other methods, we ran multiple computational experiments using both real and simulated RNA-seq data.</p><p>For the simulations, we created multiple sets of 40,000,000 paired-end reads, 100 bp in length, from the entire human genome (release GRCh37). Instead of trying to precisely mimic real RNA-seq experiments, which may not be possible in any practical sense, we generated data with relatively simple settings and expression levels, calculated using a model from the Flux Simulator system [<xref ref-type="bibr" rid="B18">18</xref>], as follows. For the first test set, we generated reads from the known transcripts on the entire human genome without introducing any mismatches or indels. We then generated additional datasets, in which we included 1) insertions and deletions into the known transcripts at random locations, and 2) insertions and deletions in the reads themselves to mimic sequencing errors (see Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>). Each of these experimental errors was introduced to test different capabilities of TopHat2 and other RNA-seq aligners. Following the simulations, we evaluated the programs using a recent, real RNA-seq dataset.</p><sec><title>Alignments of simulated reads (error-free)</title><p>We generated 40,000,000 paired-end reads and performed two sets of experiments, using: 1) 20,000,000 'left' reads from the paired-end dataset (Table <xref ref-type="table" rid="T1">1</xref>) and 2) 20,000,000 pairs of reads (Table <xref ref-type="table" rid="T2">2</xref>). Reads spanning multiple exons are called junction reads, and our single-end data contained 6,862,278 such reads (34.3%). The most challenging alignments are those for which a junction read extends by 10 bp or less into one of the exons, which we call short-anchored reads; 1,448,022 of the single-end reads (7.2%) fell into this category. We report the accuracy junction reads and short-anchored reads separately (Table <xref ref-type="table" rid="T1">1</xref>, Table <xref ref-type="table" rid="T2">2</xref>).</p><table-wrap id="T1" position="float"><label>Table 1</label><caption><p>Performance of TopHat2 and other spliced aligners on a set of 20 million 100-bp, single-end reads, simulated based on transcripts from the entire human genome.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Program</th><th align="left">No. of mapped reads</th><th align="left">Correctly mapped reads, %</th><th align="left">Incorrectly mapped reads, %</th><th align="left">Unmapped reads, %</th><th align="left"><bold>Correct junction reads, %</bold><sup>
<bold>a</bold>
</sup></th><th align="left"><bold>Correct short-anchored reads, %</bold><sup>
<bold>b</bold>
</sup></th></tr></thead><tbody><tr><td align="left">TopHat2 + Bowtie1</td><td align="left">19,826,638</td><td align="left">98.31</td><td align="left">0.82</td><td align="left">0.87</td><td align="left">95.28</td><td align="left">93.69</td></tr><tr><td colspan="7"><hr/></td></tr><tr><td align="left">TopHat2 + Bowtie2</td><td align="left">19,826,673</td><td align="left">98.03</td><td align="left">1.10</td><td align="left">0.87</td><td align="left">94.28</td><td align="left">89.67</td></tr><tr><td colspan="7"><hr/></td></tr><tr><td align="left">TopHat1.14</td><td align="left">19,616,874</td><td align="left">94.64</td><td align="left">3.45</td><td align="left">1.91</td><td align="left">84.44</td><td align="left">44.08</td></tr><tr><td colspan="7"><hr/></td></tr><tr><td align="left">GSNAP</td><td align="left">19,997,255</td><td align="left">94.21</td><td align="left">5.77</td><td align="left">0.02</td><td align="left">83.15</td><td align="left">26.01</td></tr><tr><td colspan="7"><hr/></td></tr><tr><td align="left">RUM</td><td align="left">19,555,823</td><td align="left">88.11</td><td align="left">9.67</td><td align="left">2.22</td><td align="left">65.35</td><td align="left">8.59</td></tr><tr><td colspan="7"><hr/></td></tr><tr><td align="left">MapSplice</td><td align="left">19,872,372</td><td align="left">97.28</td><td align="left">2.08</td><td align="left">0.64</td><td align="left">92.09</td><td align="left">75.57</td></tr><tr><td colspan="7"><hr/></td></tr><tr><td align="left">STAR</td><td align="left">19,087,508</td><td align="left">92.14</td><td align="left">3.30</td><td align="left">4.56</td><td align="left">77.17</td><td align="left">3.54</td></tr></tbody></table><table-wrap-foot><p><bold><sup>a</sup></bold>There were 6,862,278 reads spanning one or more splice junctions; the alignment accuracy of junction reads refers to this set.</p><p><bold><sup>b</sup></bold>There were 1,448,022 reads extending 10 bp or less into one exon; the alignment accuracy of the short-anchored reads is based on these alignments.</p></table-wrap-foot></table-wrap><table-wrap id="T2" position="float"><label>Table 2</label><caption><p>Performance of TopHat2 and other spliced aligners on a set of 20 million pairs of 100-bp reads, simulated based on transcripts from the entire human genome.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Program</th><th align="left">No. of mapped pairs</th><th align="left">Correctly mapped pairs, %</th><th align="left">Incorrectly mapped pairs, %</th><th align="left">Unmapped pairs, %</th><th align="left"><bold>Correct junction pairs, %</bold><sup>
<bold>a</bold>
</sup></th><th align="left"><bold>Correct short-anchored pairs, %</bold><sup>
<bold>b</bold>
</sup></th></tr></thead><tbody><tr><td align="left">TopHat2 + Bowtie1</td><td align="left">19,683,426</td><td align="left">96.70</td><td align="left">1.72</td><td align="left">1.58</td><td align="left">93.31</td><td align="left">90.09</td></tr><tr><td colspan="7"><hr/></td></tr><tr><td align="left">TopHat2 + Bowtie2</td><td align="left">19,686,006</td><td align="left">96.19</td><td align="left">2.24</td><td align="left">1.57</td><td align="left">92.03</td><td align="left">85.88</td></tr><tr><td colspan="7"><hr/></td></tr><tr><td align="left">TopHat1.14</td><td align="left">19,219,055</td><td align="left">89.57</td><td align="left">6.53</td><td align="left">3.90</td><td align="left">78.36</td><td align="left">40.39</td></tr><tr><td colspan="7"><hr/></td></tr><tr><td align="left">GSNAP</td><td align="left">19,999,867</td><td align="left">88.84</td><td align="left">11.16</td><td align="left">0.00</td><td align="left">76.55</td><td align="left">22.87</td></tr><tr><td colspan="7"><hr/></td></tr><tr><td align="left">RUM</td><td align="left">19,869,579</td><td align="left">79.07</td><td align="left">20.28</td><td align="left">0.65</td><td align="left">56.28</td><td align="left">8.42</td></tr><tr><td colspan="7"><hr/></td></tr><tr><td align="left">MapSplice</td><td align="left">19,342,087</td><td align="left">92.03</td><td align="left">4.68</td><td align="left">3.29</td><td align="left">86.53</td><td align="left">72.48</td></tr><tr><td colspan="7"><hr/></td></tr><tr><td align="left">STAR</td><td align="left">19,951,620</td><td align="left">85.21</td><td align="left">14.55</td><td align="left">0.24</td><td align="left">68.94</td><td align="left">3.16</td></tr></tbody></table><table-wrap-foot><p><bold><sup>a</sup></bold>There were 9,491,394 pairs of reads classified as junction pairs.</p><p><bold><sup>b</sup></bold>There were 2,702,624 pairs containing short-anchored reads.</p></table-wrap-foot></table-wrap><p>We also tested 20,000,000 read pairs (40,000,000 reads), of which 9,491,394 (47.5%) had at least one read spanning multiple exons; 2,702,624 of these pairs (13.5%) had at least one short-anchored read that extended by10 bp or less into one of its exons. Table <xref ref-type="table" rid="T2">2</xref> shows the results of mapping these reads with TopHat2 and other programs.</p><p>As shown in Table <xref ref-type="table" rid="T1">1</xref>, TopHat2 correctly aligned more than 98% of the reads, which was higher than with any of the other methods, whose accuracy ranged from 88 to 97%. The difference was more pronounced for junction reads, with TopHat2 being able to align more than 94% of the reads, whereas the other methods ranged in accuracy from 65 to 92%. GSNAP, RUM, and STAR had particular difficulty aligning short-anchored reads, aligning only 26%, 8.6%, and 3.5%, respectively, while MapSplice performed considerably better, aligning 75.6% of these reads. By contrast, using Bowtie1 as its main aligner, TopHat2 aligned 93.7% of the short-anchored reads (Table <xref ref-type="table" rid="T1">1</xref>). Both TopHat2 and MapSplice use a two-step algorithm, first detecting potential splice sites, and then using these sites to map reads. This two-step method may explain their superior performance at mapping reads with short anchors.</p><p>The results for the paired reads (Table <xref ref-type="table" rid="T2">2</xref>) were similar to those for the unpaired reads. TopHat2 aligned the highest percentage of reads (96.7%), followed by MapSplice (92%), with the other methods ranging from 79 to 88%. The difference widened again for junction reads, with TopHat2 aligning 93%, followed by MapSplice (86%), GSNAP (76%), STAR (69%), and RUM (56%). Most striking of all was the performance on short-anchored reads, which most of the methods had great difficulty aligning correctly; TopHat2 aligned 90% of these, MapSplice aligned 72%, and the other methods aligned only 3 to 22%.</p><p>We assessed alignment rates for reads, junction reads, and junction reads with small anchors for a variety of read lengths (50, 100, 150, and 200 bp) (see Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>, Figure S1). TopHat2 consistently outperformed all the other aligners for each read length. Comparing the alignment performance for junction reads with one to three mismatches, TopHat2 and MapSplice showed the highest recall rates (see Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>, Table S2).</p></sec><sec><title>Alignments of simulated reads with short indels</title><p>We tested the spliced alignment programs using reads with small indels (1 to 3 bp), using two sets of simulated reads: (1) true indels, in which the transcripts were modified by inserting or deleting one to three bases at random locations; and (2) indels caused by sequencing errors, in which indels are randomly inserted into the reads. As before, all transcripts were simulated from known genes from the entire human genome. We intentionally used a relatively high rate of indels to test the mapping capabilities of the programs in the presence of these types of mutations.</p><p>For single-end reads, RUM, GSNAP, and TopHat2 performed similarly, with 69 to 82% accuracy (recall) rates for true indels and 62 to 83% for reads with indel-sequencing errors (Table <xref ref-type="table" rid="T3">3</xref>, Table <xref ref-type="table" rid="T4">4</xref>). STAR and MapSplice showed relatively lower recall rates for both datasets. Note that when used with the original Bowtie program (a non-gapped aligner), TopHat2 was able to map 'true' indel reads using its own indel-finding algorithms.</p><table-wrap id="T3" position="float"><label>Table 3</label><caption><p>Performance of TopHat2 and other spliced aligners on single-end reads containing insertions and deletions (indels) of 1 to 3 bp.</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th align="left" colspan="2"><bold>Reads with true indels (1,428,499)</bold><sup>
<bold>a</bold>
</sup></th><th align="left" colspan="2"><bold>Reads with sequencing-error indels (1,525,657)</bold><sup>
<bold>a</bold>
</sup></th></tr><tr><th/><th colspan="4"><hr/></th></tr><tr><th align="left">Program</th><th align="left">Accuracy, %</th><th align="left"><bold>Accuracy on 351,465 reads with boundary indels, %</bold><sup>
<bold>b</bold>
</sup></th><th align="left">Accuracy, %</th><th align="left"><bold>Accuracy on 357,334 reads with boundary indels, %</bold><sup>
<bold>b</bold>
</sup></th></tr></thead><tbody><tr><td align="left">TopHat2<break/>+ Bowtie1</td><td align="left">70.9</td><td align="left">16.8</td><td align="left">12.1</td><td align="left">2.8</td></tr><tr><td colspan="5"><hr/></td></tr><tr><td align="left">TopHat2<break/>+ Bowtie2</td><td align="left">63.7</td><td align="left">25.2</td><td align="left">62.6</td><td align="left">21.2</td></tr><tr><td colspan="5"><hr/></td></tr><tr><td align="left">GSNAP</td><td align="left">82.7</td><td align="left">71.9</td><td align="left">83.1</td><td align="left">71.8</td></tr><tr><td colspan="5"><hr/></td></tr><tr><td align="left">RUM</td><td align="left">69.4</td><td align="left">43.0</td><td align="left">70.3</td><td align="left">45.4</td></tr><tr><td colspan="5"><hr/></td></tr><tr><td align="left">MapSplice</td><td align="left">27.3</td><td align="left">3.7</td><td align="left">27.5</td><td align="left">3.8</td></tr><tr><td colspan="5"><hr/></td></tr><tr><td align="left">STAR</td><td align="left">46.6</td><td align="left">16.9</td><td align="left">47.7</td><td align="left">17.1</td></tr></tbody></table><table-wrap-foot><p><bold><sup>a</sup></bold>The number of reads containing each type of error is indicated in the column header. <bold><sup>b</sup></bold>Boundary indels occur within 25 bp of an exon boundary. Percentages refer only to the reads of each type, not to the entire dataset.</p></table-wrap-foot></table-wrap><table-wrap id="T4" position="float"><label>Table 4</label><caption><p>Performance of TopHat2 and other spliced aligners on paired reads in which at least one of the reads contained insertions and deletions (indels) of 1 to 3 bp.</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th align="left" colspan="2"><bold>Pairs with true indels (2,754,313)</bold><sup>
<bold>a</bold>
</sup></th><th align="left" colspan="2"><bold>Pairs with sequencing-error indels (2,934,043)</bold><sup>
<bold>a</bold>
</sup></th></tr><tr><th/><th colspan="4"><hr/></th></tr><tr><th align="left">Program</th><th align="left">Accuracy, %</th><th align="left"><bold>Accuracy on 685,937 pairs with boundary indels, %</bold><sup>
<bold>b</bold>
</sup></th><th align="left">Accuracy, %</th><th align="left"><bold>Accuracy on 695,771 pairs with boundary indels, %</bold><sup>
<bold>b</bold>
</sup></th></tr></thead><tbody><tr><td align="left">TopHat2<break/>+ Bowtie1</td><td align="left">69.8</td><td align="left">16.3</td><td align="left">14.0</td><td align="left">3.1</td></tr><tr><td colspan="5"><hr/></td></tr><tr><td align="left">TopHat2 + Bowtie2</td><td align="left">62.3</td><td align="left">24.0</td><td align="left">60.8</td><td align="left">19.8</td></tr><tr><td colspan="5"><hr/></td></tr><tr><td align="left">GSNAP</td><td align="left">77.0</td><td align="left">63.8</td><td align="left">77.8</td><td align="left">64.8</td></tr><tr><td colspan="5"><hr/></td></tr><tr><td align="left">RUM</td><td align="left">60.3</td><td align="left">34.3</td><td align="left">61.3</td><td align="left">36.0</td></tr><tr><td colspan="5"><hr/></td></tr><tr><td align="left">MapSplice</td><td align="left">25.5</td><td align="left">3.4</td><td align="left">25.0</td><td align="left">3.2</td></tr><tr><td colspan="5"><hr/></td></tr><tr><td align="left">STAR</td><td align="left">53.4</td><td align="left">19.2</td><td align="left">54.9</td><td align="left">21.4</td></tr></tbody></table><table-wrap-foot><p><bold><sup>a</sup></bold>The number of pairs containing each type of error is indicated in the column header.</p><p><bold><sup>b</sup></bold>Boundary indels occur within 25 bp of an exon boundary. Percentages refer only to the pairs of each type, not to the entire dataset.</p></table-wrap-foot></table-wrap><p>For paired-end reads with indels, GSNAP had the highest rate of correct alignments (77%), followed by TopHat2 (60 to 69%), RUM (60 to 61%), and STAR (53 to 54%). MapSplice showed the lowest accuracy for both single-end and paired-end reads.</p><p>We defined boundary indels as those within 25 bp of a splice site. We separately computed the accuracy on all reads with boundary indels (Table <xref ref-type="table" rid="T3">3</xref>, Table <xref ref-type="table" rid="T4">4</xref>).</p></sec><sec><title>Alignment of a large set of real RNA-seq reads</title><p>Any test of alignment algorithms should use real data to provide a measure of the likely performance in practice. For these experiments, we used a recently released set of RNA-seq reads gathered across a time-course experiment reported by Chen <italic>et al</italic>. ([<xref ref-type="bibr" rid="B11">11</xref>]; GEO accession number: GSM818582). These data comprise 130,705,578 million paired-end reads in 65,352,789 pairs. All reads are 101 bp in length.</p><p>Because we did not know the true alignments for this RNA-seq dataset, we used the following objective criteria to evaluate each program: 1) the cumulative number of alignments with edit distances of 0, 1, 2, and 3 for each read; and 2) the cumulative number of spliced alignments that agree with the annotation for the corresponding human genes, taken from the Ensembl GRCh37 release of the human genome.</p><p>For each program, we aligned the paired-end reads with and without the known gene annotations, where possible. RUM is designed to run with these annotations, whereas MapSplice maps strictly without them. We then evaluated the mapping results in terms of the number of read or paired-read mappings.</p><p>TopHat2 consists of three mapping steps: 1) transcriptome mapping, which is used only when annotation is provided; 2) genome mapping; and 3) spliced mapping (see Methods for details). TopHat2 uses a remapping edit distance threshold <italic>t</italic>, specified by the user, as follows. If a read aligns to the transcriptome in step 1) with an edit distance of less than <italic>t</italic>, TopHat2 will not remap the read in subsequent steps. Otherwise, TopHat2 will try to realign the read in steps 2) and 3), and then, depending on the resulting edit distance, it will use the read to detect novel splice sites. A setting of <italic>t </italic>= 0 means that TopHat2 will realign every read in all three steps. When we used <italic>t </italic>= 0 (Figure <xref ref-type="fig" rid="F2">2</xref>: 'TopHat2 realignment 0') on the real data, we consistently obtained better mapping results in terms of edit distance and the number of alignments corresponding to known splice sites (Figures <xref ref-type="fig" rid="F2">2</xref>; Figure <xref ref-type="fig" rid="F3">3</xref>; see Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>, Figures S3-S4) for read and pair alignments, respectively (see Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>, Tables S5-S6 and Tables S10-S11).</p><fig id="F2" position="float"><label>Figure 2</label><caption><p><bold>The number of read alignments from TopHat2, GSNAP, RUM, MapSplice, and STAR. Tthe RNA-seq reads are from Chen <italic>et al. </italic></bold>[<xref ref-type="bibr" rid="B11">11</xref>]. TopHat2 was run with and without realignment (realignment edit distance of 0). TopHat2, GSNAP, and STAR were run in both <italic>de novo </italic>and gene-mapping modes, while MapSplice was run only in <italic>de novo </italic>mode and RUM was run only in gene-mapping mode. The number of alignments at each edit distance is cumulative; for instance, the number of alignments at an edit distance of 2 includes all the alignments with edit distance of 0, 1, or 2.</p></caption><graphic xlink:href="gb-2013-14-4-r36-2"/></fig><fig id="F3" position="float"><label>Figure 3</label><caption><p><bold>The number of spliced-read alignments from TopHat2, GSNAP, RUM, MapSplice, and STAR. The RNA-seq reads are from Chen <italic>et al. </italic></bold>[<xref ref-type="bibr" rid="B11">11</xref>]. TopHat2, GSNAP, and STAR were run in both <italic>de novo </italic>and gene-mapping modes while MapSplice was run only in <italic>de novo </italic>mode and RUM was run only in gene-mapping mode. For each mapping mode, the two panels on the left show the number of spliced alignments whose splice sites were found in the gene annotations, and the two panels on the right show the number of all spliced alignments including novel splice sites.</p></caption><graphic xlink:href="gb-2013-14-4-r36-3"/></fig><p>Figure <xref ref-type="fig" rid="F2">2</xref> shows the alignment performance for each program both with and without using annotations, where all the programs were configured to report alignments with edit distances of up to 3 (and more in some programs). We compared the <italic>de novo </italic>alignments of reads for edit distances of 0, 1, 2, and 3. As expected, all programs found more alignments as the maximum permissible edit distance increased. For an edit distance of 0, which allows only perfect matches, TopHat2 mapped noticeably fewer reads without its new realignment function than it did with the function. This occurs because TopHat2 first aligns reads end to end with Bowtie2 before trying spliced alignments. Thus if a read is aligned end to end with, for example, one to three mismatches, then without the realignment function, TopHat2 accepts that alignment and may miss a spliced alignment with fewer mismatches.</p><p>By contrast, TopHat2 with <italic>t </italic>= 0 mapped the largest number of reads for all edit distances, followed in most cases by GSNAP. Note that for alignments with an edit distance of up to 3, TopHat2 without realignment discovered almost as many alignments as GSNAP.</p><p>When alignment methods were run with the assistance of gene annotations (Figure <xref ref-type="fig" rid="F2">2</xref>, right panel), the results were somewhat better than the <italic>de novo </italic>alignments. TopHat2 with or without realignment produced the highest number of mappings, followed by GSNAP, RUM, and STAR. The realignment procedure gave a much smaller advantage to TopHat2 in these experiments.</p><p>One way to estimate the accuracy of mappings is to compare alignments to known splice sites. We compared all aligners on only those reads that required splitting, counting how many known (Figure <xref ref-type="fig" rid="F3">3</xref>, left) and known plus novel (Figure <xref ref-type="fig" rid="F3">3</xref>, right) splice sites they identified. For <italic>de novo </italic>alignment, TopHat2 with realignment had the highest sensitivity, followed by MapSplice. Consistent with our tests on simulated reads, GSNAP and STAR showed relatively lower alignment rates. When using annotation, TopHat2 without realignment showed the highest mapping rate, slightly outperforming TopHat2 with realignment. GSNAP and STAR, which performed less well, map reads against substrings containing splice sites rather than whole transcripts. Direct mapping against whole transcripts, as TopHat2 does, worked well, especially when mapping reads spanning small exons, where a single read might span more than two exons.</p><p>Based on these results, we suggest two alternative strategies for alignment with TopHat2. First, if gene annotations are available, as they are for the human genome and some model organisms, then these annotations should be used with TopHat2, even without realignment. Alternatively, if annotations are unavailable or incomplete, then we recommend using TopHat2 with its realignment algorithm to produce the most complete set of alignments.</p><p>The run time and the peak memory usage of the programs used in this study varied greatly. We compared performance on all programs using the Chen <italic>et al</italic>. data [<xref ref-type="bibr" rid="B11">11</xref>] of 130 million reads (see Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>, Table S8). Overall, STAR is much faster (32 minutes) than the other programs, which required from 8 to 55 hours. However, STAR requires a large amount of real memory, at least 28 GB, whereas most of the other programs required less than 8 GB.</p></sec><sec><title>Effects of pseudogenes on RNA-seq mapping</title><p>The Ensembl gene annotations (release 66) contain 32,439 genes, including non-coding RNA genes, and over 14,000 pseudogenes. Of the real genes, we found that 872 (2.7%) genes had pseudogene copies; that is, at least one transcript (or isoform) can be aligned to a pseudogene with at least 80% identity across the full length of the transcript. Using data from the Chen <italic>et al</italic>. study [<xref ref-type="bibr" rid="B11">11</xref>] and from the Illumina Body Map project [<xref ref-type="bibr" rid="B12">12</xref>], we found that genes with pseudogene copies seem to have higher expression levels than those without pseudogene copies. Table <xref ref-type="table" rid="T5">5</xref> shows the proportion of reads mapping to genes with pseudogenes, using both the raw count and a normalized count divided by the length of the transcript. Although only 2.7% of genes have pseudogene copies, these genes account for 22.5% (non-normalized) or 26.9% (normalized) of the RNA-seq reads in the Chen <italic>et al</italic>. data. In the RNA-seq experiments from the Illumina Body Map (the white blood sample only), we saw 19.1% (normalized) of reads mapping to genes with pseudogenes (see Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>; Table S12). From both RNA-seq experiments, we noted that genes with multiple pseudogene copies were more abundantly expressed than those with a single pseudogene copy. We ran a similar analysis looking only at the 20,417 protein-coding genes in Ensembl, with similar results: 22% of read pairs (26 times the number expected) mapped to genes with processed pseudogenes (see Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>; Table S13).</p><table-wrap id="T5" position="float"><label>Table 5</label><caption><p>Expression levels of genes with pseudogene copies from Chen <italic>et al</italic>. [<xref ref-type="bibr" rid="B11">11</xref>].<sup>a</sup></p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><bold>Number of pseudogene copies</bold><sup>
<bold>b</bold>
</sup></th><th align="left"><bold>Gene with pseudogene copies (%)</bold><sup>
<bold>c</bold>
</sup></th><th align="left">Pair<break/><bold>count, %</bold><sup>d</sup></th><th align="left"><bold>Ratio</bold><sup>e</sup></th><th align="left"><bold>Normalized count, %</bold><sup>f</sup></th><th align="left"><bold>Normalized ratio</bold><sup>f</sup></th></tr></thead><tbody><tr><td align="left">1</td><td align="left">553 (1.7%)</td><td align="left">6.85</td><td align="left">&#x000d7; 4.02</td><td align="left">9.37</td><td align="left">&#x000d7; 5.49</td></tr><tr><td colspan="6"><hr/></td></tr><tr><td align="left">2</td><td align="left">113 (0.4)</td><td align="left">5.15</td><td align="left">&#x000d7; 14.79</td><td align="left">5.20</td><td align="left">&#x000d7; 14.93</td></tr><tr><td colspan="6"><hr/></td></tr><tr><td align="left">3</td><td align="left">49 (0.2)</td><td align="left">1.27</td><td align="left">&#x000d7; 8.38</td><td align="left">1.96</td><td align="left">&#x000d7; 12.99</td></tr><tr><td colspan="6"><hr/></td></tr><tr><td align="left">4</td><td align="left">27 (0.1)</td><td align="left">2.27</td><td align="left">&#x000d7; 27.32</td><td align="left">2.28</td><td align="left">&#x000d7; 27.35</td></tr><tr><td colspan="6"><hr/></td></tr><tr><td align="left">&#x02265; 5</td><td align="left">130 (0.4)</td><td align="left">6.91</td><td align="left">&#x000d7; 17.24</td><td align="left">8.08</td><td align="left">&#x000d7; 20.16</td></tr><tr><td colspan="6"><hr/></td></tr><tr><td align="left">Total (&#x02265; 1)</td><td align="left">872/32,439 (2.7)</td><td align="left">22.45</td><td align="left">&#x000d7; 8.35</td><td align="left">26.88</td><td align="left">&#x000d7; 10.00</td></tr></tbody></table><table-wrap-foot><p><sup>a</sup>Using Bowtie2, we aligned RNA-seq paired-end reads to 32,439 annotated genes.</p><p><sup>b</sup>Number of pseudogene copies of a gene. The first row shows genes that have just one pseudogene, followed by rows for genes with two, three, four, and at least five pseudogene copies.</p><p><sup>c</sup>Number of genes with the specified number of pseudogene copies; for example, 553 genes (1.7% of all genes) have one pseudogene copy.</p><p><sup>d</sup>Percentage of read pairs that were mapped to genes with pseudogene copies.</p><p><sup>e</sup>Ratio of columns 3 and 2.</p><p><sup>f</sup>These two columns were similarly defined using a normalized count, where the number of reads mapping to each gene was normalized to account for gene length.</p></table-wrap-foot></table-wrap><p>Figure <xref ref-type="fig" rid="F4">4</xref> shows various mapping results from TopHat2 with and without realignments at various edit distances. As we allowed TopHat2 to realign more reads, it found the spliced alignments that were otherwise hidden by pseudogene alignments. This in turn substantially increased its mapping rates for known splice sites.</p><fig id="F4" position="float"><label>Figure 4</label><caption><p><bold>The number of read and spliced-read alignments from TopHat2, using different realignment edit distances and no realignment</bold>. Edit distances of 0, 1, and 2 were used. As TopHat2 allows more realignment from no realignment to 2 to 1 to 0, the number of read alignments and spliced-read alignments increases, so that the differences in the numbers of read alignments from TopHat run with different realignment edit distance are mostly explained by the increase in the number of spliced-read alignments.</p></caption><graphic xlink:href="gb-2013-14-4-r36-4"/></fig></sec><sec><title>The completeness of human gene annotations</title><p>Using the <italic>de novo </italic>mapping mode in TopHat2, GSNAP, MapSplice, and STAR, we looked at how many spliced alignments were found in the Ensembl annotations. The proportions of spliced mappings to known splice sites were 88 to 90%, 97%, 96%, and 83 to 93% in TopHat2, GSNAP, STAR, and MapSplice, respectively (Figure <xref ref-type="fig" rid="F5">5</xref>). Although this analysis considered only the RNA-seq data from Chen <italic>et al. </italic>[<xref ref-type="bibr" rid="B11">11</xref>], the TopHat2 result suggests that many additional spliced alignments, up to 12%, might remain to be discovered. Most of the novel splicing events in these alignments were supported by 10 or more reads that extended for 50 or more bases on each side.</p><fig id="F5" position="float"><label>Figure 5</label><caption><p><bold>The number of spliced-read alignments from TopHat2, GSNAP, STAR, and MapSplice without using gene annotation</bold>. The number of read alignments whose splice sites were found in the gene annotations are shown in brown, and the number of all spliced-read alignments including novel splice sites are shown in green.</p></caption><graphic xlink:href="gb-2013-14-4-r36-5"/></fig></sec></sec><sec sec-type="conclusions"><title>Conclusions</title><p>Discovery of new genes and transcripts is a major objective in many RNA-seq experiments. Deep RNA-seq experiments continue to uncover previously unseen elements of the transcriptome, even in well-studied organisms. Mapping reads to the genome is a core step in such screens, and the accuracy of mapping software can determine the accuracy of downstream steps such as gene and transcript discovery or expression quantification.</p><p>We have described TopHat2, which provides major accuracy improvements over previous versions and over other RNA-seq mapping tools. Because TopHat2 is built around Bowtie2, it can now align reads across small indels with high accuracy, a feature crucial for studies assessing the effects of genetic mutations on gene and transcript expression. TopHat2 is engineered to work well with a wide range of RNA-seq experimental designs, and it is optimized for the widely available long paired-end reads. These reads pose new challenges because they can span multiple splice sites rather than just one or two; we estimate that nearly half of reads 150 bp long will span two or more human exons. The algorithmic improvements in TopHat2 address this challenge, maintaining both accuracy and speed. Other refinements to the algorithm increase accuracy for reads that span a junction with only a small (&#x02264; 10 bp) overhang, reducing errors in downstream transcript assembly using tools such as Cufflinks. TopHat2 also makes powerful use of available gene annotations, which allow it to avoid erroneously mapping reads to pseudogenes, and generally improve its overall alignment accuracy. Annotation also allows TopHat2 to better align reads that cover microexons, non-canonical splice sites, and other 'unusual' features of eukaryotic transcriptomes.</p><p>We have shown that TopHat2 performs well over a wide range of read lengths, making it a good fit for most RNA-seq experimental designs. This scalability suggests that as read lengths grow, TopHat2 will continue to report accurate, sensitive alignment results and allow for robust downstream analysis. We believe that TopHat2 reports more accurate alignments than competing tools, using fewer computational resources. RNA-seq experiments are becoming increasingly common and are now routinely used by many biologists. We expect that TopHat2 will provide these scientists with accurate results for use with expression analysis, gene discovery, and many other applications.</p></sec><sec sec-type="methods"><title>Methods</title><p>Given RNA-seq reads as input, TopHat2 begins by mapping reads against the known transcriptome, if an annotation file is provided. This transcriptome mapping improves the overall sensitivity and accuracy of the mapping. It also gives the whole pipeline a significant speed increase, owing to the much smaller size of the transcriptome compared with that of the genome (see Figure <xref ref-type="fig" rid="F6">6</xref>).</p><fig id="F6" position="float"><label>Figure 6</label><caption><p><bold>TopHat2 pipeline</bold>. Details are given in the main text.</p></caption><graphic xlink:href="gb-2013-14-4-r36-6"/></fig><p>After the transcriptome-mapping step, some reads remain unmapped because they are derived from unknown transcripts not present in the annotation, or because they contain many miscalled bases. In addition, there may be poorly aligned reads that have been mapped to the wrong location. TopHat2 aligns these unmapped or potentially misaligned reads against the genome (Figure <xref ref-type="fig" rid="F6">6</xref>, step 2). Any reads contained entirely within exons will be mapped, whereas other spanning introns may not be.</p><p>Using unmapped reads from step 2, TopHat2 tries to find novel splice sites that are based on known junction signals (GT-AG, GC-AG, and AT-AC). TopHat2 also provides an option to allow users to remap some of the mapped reads, depending on the edit distance values of these reads; that is, those reads whose edit distance is greater than or equal to a user-provided threshold will be treated as unmapped reads. To accomplish this, the unmapped reads (and previously mapped reads with low alignment scores) are split into smaller non-overlapping segments (25 bp each by default) which are then aligned against the genome (Figure <xref ref-type="fig" rid="F6">6</xref>, step 3). Tophat2 examines any cases in which the left and right segments of the same read are mapped within a user-defined maximum intron size (usually between 50 and 100,000 bp). When this pattern is detected, TopHat2 re-aligns the entire read sequence to that genomic region in order to identify the most likely locations of the splice sites (Figure <xref ref-type="fig" rid="F6">6</xref>). Using a similar approach, indels and fusion breakpoints are also detected in this step.</p><p>The genomic sequences flanking these splice sites are concatenated, and the resulting spliced sequences are collected as a set of potential transcript fragments. Any reads not mapped in the previous stages (or mapped very poorly) are then re-aligned with Bowtie2 [<xref ref-type="bibr" rid="B15">15</xref>] against this novel transcriptome.</p><p>After these steps, some of the reads may have been aligned incorrectly by extending an exonic alignment a few bases into the adjacent intron (Figure <xref ref-type="fig" rid="F1">1</xref>; Figure <xref ref-type="fig" rid="F6">6</xref>, steps 3 to 5). TopHat2 checks if such alignments extend into the introns identified in the split-alignment phase; if so, it can realign these reads to the adjacent exons instead.</p><p>In the final stage, TopHat2 divides the reads into those with unique alignments and those with multiple alignments. For the multi-mapped reads, TopHat2 gathers statistical information (for example, the number of supporting reads) about the relevant splice junctions, insertions, and deletions, which it uses to recalculate the alignment score for each read. Based on these new alignment scores, TopHat2 reports the most likely alignment locations for such multi-mapped reads.</p><p>For paired-end reads, TopHat2 processes the two reads separately through the same mapping stages described above. In the final stage, the independently aligned reads are analyzed together to produce paired alignments, taking into consideration additional factors including fragment length and orientation.</p><p>For the experiments described in this study, the program version numbers were: TopHat2 2.0.8, TopHat1 1.1.4, GSNAP 2013-01-23, RUM 1.12_01, MapSplice 1.15.2, and STAR 2.3.0e. For the specific parameters for each program, see Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>, Table S9, and for the source code of TopHat 2.0.8, see Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>.</p></sec><sec><title>Abbreviations</title><p>bp: Base pair; indel: Insertion or deletion; RNA-seq: RNA sequence;</p></sec><sec><title>Authors' contributions</title><p>DK, SLS, GP, and CT performed the analysis and discussed the results of TopHat2. DK, GP, and CT were mainly responsible for implementing TopHat2. HP implemented the transcriptome-mapping algorithms, with help from GP and DK. RK implemented the indel-alignment algorithms, with help from DK. DK, SLS, GP, and CT wrote the manuscript. All authors read and approved the final manuscript.</p></sec><sec sec-type="supplementary-material"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="S1"><caption><title>Additional File 1</title><p><bold>Supplementary material</bold>.</p></caption><media xlink:href="gb-2013-14-4-r36-S1.DOCX"><caption><p>Click here for file</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="S2"><caption><title>Additional File 2</title><p><bold>TopHat2 source code</bold>.</p></caption><media xlink:href="gb-2013-14-4-r36-S2.GZ"><caption><p>Click here for file</p></caption></media></supplementary-material></sec></body><back><sec><title>Acknowledgements</title><p>We thank Lior Patcher and Adam Roberts for their invaluable contributions to our discussions on the TopHat2 pipeline. This work is supported in part by the National Human Genome Research Institute (NIH) under grants R01-HG006102 and R01-HG006677.</p></sec><ref-list><ref id="B1"><mixed-citation publication-type="journal"><name><surname>Mortazavi</surname><given-names>A</given-names></name><name><surname>Williams</surname><given-names>BA</given-names></name><name><surname>McCue</surname><given-names>K</given-names></name><name><surname>Schaeffer</surname><given-names>L</given-names></name><name><surname>Wold</surname><given-names>B</given-names></name><article-title>Mapping and quantifying mammalian transcriptomes by RNA-Seq.</article-title><source>Nat Methods</source><year>2008</year><volume>14</volume><fpage>621</fpage><lpage>628</lpage><pub-id pub-id-type="doi">10.1038/nmeth.1226</pub-id><pub-id pub-id-type="pmid">18516045</pub-id></mixed-citation></ref><ref id="B2"><mixed-citation publication-type="journal"><name><surname>Pei</surname><given-names>B</given-names></name><name><surname>Sisu</surname><given-names>C</given-names></name><name><surname>Frankish</surname><given-names>A</given-names></name><name><surname>Howald</surname><given-names>C</given-names></name><name><surname>Habegger</surname><given-names>L</given-names></name><name><surname>Mu</surname><given-names>XJ</given-names></name><name><surname>Harte</surname><given-names>R</given-names></name><name><surname>Balasubramanian</surname><given-names>S</given-names></name><name><surname>Tanzer</surname><given-names>A</given-names></name><name><surname>Diekhans</surname><given-names>M</given-names></name><name><surname>Reymond</surname><given-names>A</given-names></name><name><surname>Hubbard</surname><given-names>TJ</given-names></name><name><surname>Harrow</surname><given-names>J</given-names></name><name><surname>Gerstein</surname><given-names>MB</given-names></name><article-title>The GENCODE pseudogene resource.</article-title><source>Genome Biol</source><year>2012</year><volume>14</volume><fpage>R51</fpage><pub-id pub-id-type="doi">10.1186/gb-2012-13-9-r51</pub-id><pub-id pub-id-type="pmid">22951037</pub-id></mixed-citation></ref><ref id="B3"><mixed-citation publication-type="journal"><name><surname>Roberts</surname><given-names>A</given-names></name><name><surname>Trapnell</surname><given-names>C</given-names></name><name><surname>Donaghey</surname><given-names>J</given-names></name><name><surname>Rinn</surname><given-names>JL</given-names></name><name><surname>Pachter</surname><given-names>L</given-names></name><article-title>Improving RNA-Seq expression estimates by correcting for fragment bias.</article-title><source>Genome Biol</source><year>2011</year><volume>14</volume><fpage>R22</fpage><pub-id pub-id-type="doi">10.1186/gb-2011-12-3-r22</pub-id><pub-id pub-id-type="pmid">21410973</pub-id></mixed-citation></ref><ref id="B4"><mixed-citation publication-type="journal"><name><surname>Trapnell</surname><given-names>C</given-names></name><name><surname>Pachter</surname><given-names>L</given-names></name><name><surname>Salzberg</surname><given-names>SL</given-names></name><article-title>TopHat: discovering splice junctions with RNA-Seq.</article-title><source>Bioinformatics</source><year>2009</year><volume>14</volume><fpage>1105</fpage><lpage>1111</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btp120</pub-id><pub-id pub-id-type="pmid">19289445</pub-id></mixed-citation></ref><ref id="B5"><mixed-citation publication-type="journal"><name><surname>Wu</surname><given-names>TD</given-names></name><name><surname>Nacu</surname><given-names>S</given-names></name><article-title>Fast and SNP-tolerant detection of complex variants and splicing in short reads.</article-title><source>Bioinformatics</source><year>2010</year><volume>14</volume><fpage>873</fpage><lpage>881</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btq057</pub-id><pub-id pub-id-type="pmid">20147302</pub-id></mixed-citation></ref><ref id="B6"><mixed-citation publication-type="journal"><name><surname>Grant</surname><given-names>GR</given-names></name><name><surname>Farkas</surname><given-names>MH</given-names></name><name><surname>Pizarro</surname><given-names>AD</given-names></name><name><surname>Lahens</surname><given-names>NF</given-names></name><name><surname>Schug</surname><given-names>J</given-names></name><name><surname>Brunk</surname><given-names>BP</given-names></name><name><surname>Stoeckert</surname><given-names>CJ</given-names></name><name><surname>Hogenesch</surname><given-names>JB</given-names></name><name><surname>Pierce</surname><given-names>EA</given-names></name><article-title>Comparative analysis of RNA-Seq alignment algorithms and the RNA-Seq unified mapper (RUM).</article-title><source>Bioinformatics</source><year>2011</year><volume>14</volume><fpage>2518</fpage><lpage>2528</lpage><pub-id pub-id-type="pmid">21775302</pub-id></mixed-citation></ref><ref id="B7"><mixed-citation publication-type="journal"><name><surname>Dobin</surname><given-names>A</given-names></name><name><surname>Davis</surname><given-names>CA</given-names></name><name><surname>Schlesinger</surname><given-names>F</given-names></name><name><surname>Drenkow</surname><given-names>J</given-names></name><name><surname>Zaleski</surname><given-names>C</given-names></name><name><surname>Jha</surname><given-names>S</given-names></name><name><surname>Batut</surname><given-names>P</given-names></name><name><surname>Chaisson</surname><given-names>M</given-names></name><name><surname>Gingeras</surname><given-names>TR</given-names></name><article-title>STAR: ultrafast universal RNA-seq aligner.</article-title><source>Bioinformatics</source><year>2013</year><volume>14</volume><fpage>15</fpage><lpage>21</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/bts635</pub-id><pub-id pub-id-type="pmid">23323971</pub-id></mixed-citation></ref><ref id="B8"><mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>K</given-names></name><name><surname>Singh</surname><given-names>D</given-names></name><name><surname>Zeng</surname><given-names>Z</given-names></name><name><surname>Coleman</surname><given-names>SJ</given-names></name><name><surname>Huang</surname><given-names>Y</given-names></name><name><surname>Savich</surname><given-names>GL</given-names></name><name><surname>He</surname><given-names>X</given-names></name><name><surname>Mieczkowski</surname><given-names>P</given-names></name><name><surname>Grimm</surname><given-names>SA</given-names></name><name><surname>Perou</surname><given-names>CM</given-names></name><name><surname>MacLeod</surname><given-names>JN</given-names></name><name><surname>Chiang</surname><given-names>DY</given-names></name><name><surname>Prins</surname><given-names>JF</given-names></name><name><surname>Liu</surname><given-names>J</given-names></name><article-title>MapSplice: accurate mapping of RNA-seq reads for splice junction discovery.</article-title><source>Nucleic Acids Res</source><year>2010</year><volume>14</volume><fpage>e178</fpage><pub-id pub-id-type="doi">10.1093/nar/gkq622</pub-id><pub-id pub-id-type="pmid">20802226</pub-id></mixed-citation></ref><ref id="B9"><mixed-citation publication-type="journal"><name><surname>Zhang</surname><given-names>Z</given-names></name><name><surname>Harrison</surname><given-names>PM</given-names></name><name><surname>Liu</surname><given-names>Y</given-names></name><name><surname>Gerstein</surname><given-names>M</given-names></name><article-title>Millions of years of evolution preserved: a comprehensive catalog of the processed pseudogenes in the human genome.</article-title><source>Genome Res</source><year>2003</year><volume>14</volume><fpage>2541</fpage><lpage>2558</lpage><pub-id pub-id-type="doi">10.1101/gr.1429003</pub-id><pub-id pub-id-type="pmid">14656962</pub-id></mixed-citation></ref><ref id="B10"><mixed-citation publication-type="journal"><name><surname>Kalyana-Sundaram</surname><given-names>S</given-names></name><name><surname>Kumar-Sinha</surname><given-names>C</given-names></name><name><surname>Shankar</surname><given-names>S</given-names></name><name><surname>Robinson</surname><given-names>DR</given-names></name><name><surname>Wu</surname><given-names>YM</given-names></name><name><surname>Cao</surname><given-names>X</given-names></name><name><surname>Asangani</surname><given-names>IA</given-names></name><name><surname>Kothari</surname><given-names>V</given-names></name><name><surname>Prensner</surname><given-names>JR</given-names></name><name><surname>Lonigro</surname><given-names>RJ</given-names></name><name><surname>Iyer</surname><given-names>MK</given-names></name><name><surname>Barrette</surname><given-names>T</given-names></name><name><surname>Shanmugam</surname><given-names>A</given-names></name><name><surname>Dhanasekaran</surname><given-names>SM</given-names></name><name><surname>Palanisamy</surname><given-names>N</given-names></name><name><surname>Chinnaiyan</surname><given-names>AM</given-names></name><article-title>Expressed pseudogenes in the transcriptional landscape of human cancers.</article-title><source>Cell</source><year>2012</year><volume>14</volume><fpage>1622</fpage><lpage>1634</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2012.04.041</pub-id><pub-id pub-id-type="pmid">22726445</pub-id></mixed-citation></ref><ref id="B11"><mixed-citation publication-type="journal"><name><surname>Chen</surname><given-names>R</given-names></name><name><surname>Mias</surname><given-names>GI</given-names></name><name><surname>Li-Pook-Than</surname><given-names>J</given-names></name><name><surname>Jiang</surname><given-names>L</given-names></name><name><surname>Lam</surname><given-names>HY</given-names></name><name><surname>Miriami</surname><given-names>E</given-names></name><name><surname>Karczewski</surname><given-names>KJ</given-names></name><name><surname>Hariharan</surname><given-names>M</given-names></name><name><surname>Dewey</surname><given-names>FE</given-names></name><name><surname>Cheng</surname><given-names>Y</given-names></name><name><surname>Clark</surname><given-names>MJ</given-names></name><name><surname>Im</surname><given-names>H</given-names></name><name><surname>Habegger</surname><given-names>L</given-names></name><name><surname>Balasubramanian</surname><given-names>S</given-names></name><name><surname>O'Huallachain</surname><given-names>M</given-names></name><name><surname>Dudley</surname><given-names>JT</given-names></name><name><surname>Hillenmeyer</surname><given-names>S</given-names></name><name><surname>Haraksingh</surname><given-names>R</given-names></name><name><surname>Sharon</surname><given-names>D</given-names></name><name><surname>Euskirchen</surname><given-names>G</given-names></name><name><surname>Lacroute</surname><given-names>P</given-names></name><name><surname>Bettinger</surname><given-names>K</given-names></name><name><surname>Boyle</surname><given-names>AP</given-names></name><name><surname>Kasowski</surname><given-names>M</given-names></name><name><surname>Grubert</surname><given-names>F</given-names></name><name><surname>Seki</surname><given-names>S</given-names></name><name><surname>Garcia</surname><given-names>M</given-names></name><name><surname>Whirl-Carrillo</surname><given-names>M</given-names></name><name><surname>Gallardo</surname><given-names>M</given-names></name><name><surname>Blasco</surname><given-names>MA</given-names></name><etal/><article-title>Personal omics profiling reveals dynamic molecular and medical phenotypes.</article-title><source>Cell</source><year>2012</year><volume>14</volume><fpage>1293</fpage><lpage>1307</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2012.02.009</pub-id><pub-id pub-id-type="pmid">22424236</pub-id></mixed-citation></ref><ref id="B12"><mixed-citation publication-type="other"><article-title>The Illumina Body Map 2.0 data.</article-title><ext-link ext-link-type="uri" xlink:href="http://www.ebi.ac.uk/arrayexpress/browse.html?keywords=E-MTAB-513&#x00026;expandefo=on">http://www.ebi.ac.uk/arrayexpress/browse.html?keywords=E-MTAB-513&#x00026;expandefo=on</ext-link></mixed-citation></ref><ref id="B13"><mixed-citation publication-type="journal"><name><surname>Xing</surname><given-names>J</given-names></name><name><surname>Zhang</surname><given-names>Y</given-names></name><name><surname>Han</surname><given-names>K</given-names></name><name><surname>Salem</surname><given-names>AH</given-names></name><name><surname>Sen</surname><given-names>SK</given-names></name><name><surname>Huff</surname><given-names>CD</given-names></name><name><surname>Zhou</surname><given-names>Q</given-names></name><name><surname>Kirkness</surname><given-names>EF</given-names></name><name><surname>Levy</surname><given-names>S</given-names></name><name><surname>Batzer</surname><given-names>MA</given-names></name><name><surname>Jorde</surname><given-names>LB</given-names></name><article-title>Mobile elements create structural variation: analysis of a complete human genome.</article-title><source>Genome Res</source><year>2009</year><volume>14</volume><fpage>1516</fpage><lpage>1526</lpage><pub-id pub-id-type="doi">10.1101/gr.091827.109</pub-id><pub-id pub-id-type="pmid">19439515</pub-id></mixed-citation></ref><ref id="B14"><mixed-citation publication-type="journal"><name><surname>Levy</surname><given-names>S</given-names></name><name><surname>Sutton</surname><given-names>G</given-names></name><name><surname>Ng</surname><given-names>PC</given-names></name><name><surname>Feuk</surname><given-names>L</given-names></name><name><surname>Halpern</surname><given-names>AL</given-names></name><name><surname>Walenz</surname><given-names>BP</given-names></name><name><surname>Axelrod</surname><given-names>N</given-names></name><name><surname>Huang</surname><given-names>J</given-names></name><name><surname>Kirkness</surname><given-names>EF</given-names></name><name><surname>Denisov</surname><given-names>G</given-names></name><name><surname>Lin</surname><given-names>Y</given-names></name><name><surname>MacDonald</surname><given-names>JR</given-names></name><name><surname>Pang</surname><given-names>AW</given-names></name><name><surname>Shago</surname><given-names>M</given-names></name><name><surname>Stockwell</surname><given-names>TB</given-names></name><name><surname>Tsiamouri</surname><given-names>A</given-names></name><name><surname>Bafna</surname><given-names>V</given-names></name><name><surname>Bansal</surname><given-names>V</given-names></name><name><surname>Kravitz</surname><given-names>SA</given-names></name><name><surname>Busam</surname><given-names>DA</given-names></name><name><surname>Beeson</surname><given-names>KY</given-names></name><name><surname>McIntosh</surname><given-names>TC</given-names></name><name><surname>Remington</surname><given-names>KA</given-names></name><name><surname>Abril</surname><given-names>JF</given-names></name><name><surname>Gill</surname><given-names>J</given-names></name><name><surname>Borman</surname><given-names>J</given-names></name><name><surname>Rogers</surname><given-names>YH</given-names></name><name><surname>Frazier</surname><given-names>ME</given-names></name><name><surname>Scherer</surname><given-names>SW</given-names></name><name><surname>Strausberg</surname><given-names>RL</given-names></name><etal/><article-title>The diploid genome sequence of an individual human.</article-title><source>PLoS Biol</source><year>2007</year><volume>14</volume><fpage>e254</fpage><pub-id pub-id-type="doi">10.1371/journal.pbio.0050254</pub-id><pub-id pub-id-type="pmid">17803354</pub-id></mixed-citation></ref><ref id="B15"><mixed-citation publication-type="journal"><name><surname>Langmead</surname><given-names>B</given-names></name><name><surname>Salzberg</surname><given-names>SL</given-names></name><article-title>Fast gapped-read alignment with Bowtie 2.</article-title><source>Nat Methods</source><year>2012</year><volume>14</volume><fpage>357</fpage><lpage>359</lpage><pub-id pub-id-type="doi">10.1038/nmeth.1923</pub-id><pub-id pub-id-type="pmid">22388286</pub-id></mixed-citation></ref><ref id="B16"><mixed-citation publication-type="journal"><name><surname>Kim</surname><given-names>D</given-names></name><name><surname>Salzberg</surname><given-names>SL</given-names></name><article-title>TopHat-Fusion: an algorithm for discovery of novel fusion transcripts.</article-title><source>Genome Biol</source><year>2011</year><volume>14</volume><fpage>R72</fpage><pub-id pub-id-type="doi">10.1186/gb-2011-12-8-r72</pub-id><pub-id pub-id-type="pmid">21835007</pub-id></mixed-citation></ref><ref id="B17"><mixed-citation publication-type="journal"><name><surname>Langmead</surname><given-names>B</given-names></name><name><surname>Trapnell</surname><given-names>C</given-names></name><name><surname>Pop</surname><given-names>M</given-names></name><name><surname>Salzberg</surname><given-names>SL</given-names></name><article-title>Ultrafast and memory-efficient alignment of short DNA sequences to the human genome.</article-title><source>Genome Biol</source><year>2009</year><volume>14</volume><fpage>R25</fpage><pub-id pub-id-type="doi">10.1186/gb-2009-10-3-r25</pub-id><pub-id pub-id-type="pmid">19261174</pub-id></mixed-citation></ref><ref id="B18"><mixed-citation publication-type="other"><name><surname>Griebel</surname><given-names>T</given-names></name><name><surname>Zacher</surname><given-names>B</given-names></name><name><surname>Ribeca</surname><given-names>P</given-names></name><name><surname>Raineri</surname><given-names>E</given-names></name><name><surname>Lacroix</surname><given-names>V</given-names></name><name><surname>Guigo</surname><given-names>R</given-names></name><name><surname>Sammeth</surname><given-names>M</given-names></name><article-title>Modelling and simulating generic RNA-Seq experiments with the flux simulator.</article-title><source>Nucleic acids Res</source><year>2012</year></mixed-citation></ref></ref-list></back></article>